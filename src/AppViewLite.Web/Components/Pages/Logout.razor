@page "/logout"
@inject NavigationManager Navigation
@inject IHttpContextAccessor HttpContextAccessor
@inject BlueskyEnrichedApis Apis

<form method="post" @onsubmit="Submit" @formname="logoutForm" id="logoutForm">
    <AntiforgeryToken />
    Logging out...
</form>
<script>
    document.getElementById('logoutForm').submit();
</script>

@code {
    [SupplyParameterFromForm]
    private LoginData? Model { get; set; }

    protected override void OnInitialized() => Model ??= new();

    private void Submit()
    {

        var cookie = Program.TryGetSessionCookie(HttpContextAccessor.HttpContext!);
        if (cookie != null)
        {
            Apis.LogOut(cookie);
        }
        Navigation.NavigateTo("/", true);
        
    }

    public class LoginData
    {
    }
}


